<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VoltRace Online</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>âš¡</text></svg>">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>

<body>

    <script>
        /* 'safe' evita que Jinja2 escape las comillas del JSON */
        window.VOLTRACE_USER_DATA = {{ user_data_json | safe }};
    </script>
    
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="flashes">
            {% for category, message in messages %}
                <div class="flash-{{ category }}">{{ message }}</div>
            {% endfor %}
            </div>
        {% endif %}
    {% endwith %}
    
    <div class="container">
        <div id="auth-screen" class="screen active">
            <div class="header">
                <h1>ğŸ² VoltRace Online</h1>
                <p>Â¡Crea tu cuenta o inicia sesiÃ³n para jugar!</p>
            </div>
            <div class="auth-content">
                <div class="auth-tabs">
                    <button id="tab-login" class="tab-button active">Iniciar SesiÃ³n</button>
                    <button id="tab-register" class="tab-button">Registrarse</button>
                </div>
                <div id="login-form" class="auth-form active">
                    <div class="card">
                        <h3>ğŸ” Iniciar SesiÃ³n</h3>
                        <div class="form-group auth-form-column">
                            <div class="input-group">
                                <label for="login-email">Email:</label>
                                <input type="email" id="login-email" placeholder="tu@email.com" required class="text-input">
                            </div>
                            <div class="input-group">
                                <label for="login-password">ContraseÃ±a:</label>
                                <input type="password" id="login-password" placeholder="ContraseÃ±a" required class="text-input">
                            </div>
                            <div style="text-align: right; font-size: 0.9em; margin-top: 5px; margin-bottom: 10px;">
                                <a href="{{ url_for('forgot_password') }}" style="color: var(--primary); text-decoration: none;">
                                    Â¿Olvidaste tu contraseÃ±a?
                                </a>
                            </div>
                            <button id="btn-login" class="btn-primary">Entrar</button>
                        </div>
                    </div>
                </div>
                <div id="register-form" class="auth-form">
                    <div class="card">
                        <h3>ğŸ“ Crear Cuenta</h3>
                        <div class="form-group auth-form-column">
                            <div class="input-group">
                                <label for="register-email">Email:</label>
                                <input type="email" id="register-email" placeholder="tu@email.com" required autocomplete="email" class="text-input">
                            </div>
                            <div class="input-group">
                                <label for="register-username">Nombre de Usuario:</label>
                                <input type="text" id="register-username" placeholder="min. 3 caracteres" required minlength="3" autocomplete="username" class="text-input">
                            </div>
                            <div class="input-group">
                                <label for="register-password">ContraseÃ±a:</label>
                                <input type="password" id="register-password" placeholder="min. 6 caracteres" required minlength="6" autocomplete="new-password" class="text-input">
                            </div>
                            <button id="btn-register" class="btn-success">Crear Cuenta</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="lobby-screen" class="screen">
            <div class="header">
                <div>
                    <h1>ğŸ² VoltRace Online</h1>
                    <p>Â¡Juega con amigos desde cualquier parte del mundo!</p>
                </div>
                <div class="user-info">
                    <div class="user-profile">
                        <span id="user-username">ğŸ‘¤ Usuario</span>
                        <button id="btn-edit-avatar" class="btn-secondary" title="Cambiar Avatar" style="padding: 2px 6px; font-size: 0.8em;">âœï¸</button>
                        <div class="xp-bar-container">
                            <span id="user-level-text">â­ Nivel 1</span>
                            <progress id="user-xp-bar" value="0" max="500"></progress>
                            <span id="user-xp-text">0 / 500 XP</span>
                        </div>
                        <button id="btn-social" class="btn-secondary" title="Amigos y Chat">ğŸ‘¥ Social</button>
                        <button id="btn-show-achievements" class="btn-secondary" title="Ver Logros">ğŸ† Logros</button>
                        <button id="btn-show-glossary" class="btn-secondary" title="Ver Glosario">ğŸ“š Glosario</button>
                        <button id="btn-abrir-kits" class="btn-secondary" title="Elegir Kit">ğŸ› ï¸ Elegir Kit</button>
                        <button id="btn-show-arsenal" class="btn-secondary" title="Ver MaestrÃ­a de Kits">ğŸ›¡ï¸ Arsenal</button>
                        <button id="btn-toggle-animations" class="btn-secondary" title="Activar/Desactivar animaciones">ğŸ¬</button>
                        
                        <div class="volume-control">
                            <span id="volume-icon" class="btn-secondary" title="Silenciar">ğŸ”Š</span>
                            <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.5">
                        </div>
                        <button id="btn-logout" class="btn-secondary">ğŸšª Cerrar SesiÃ³n</button>
                    </div>
                </div>
            </div>

            <div class="lobby-content">
                
                <div class="lobby-column" id="stats-column">
                    <div class="card">
                        <h3>ğŸ“Š Mis EstadÃ­sticas</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <span>Partidas Jugadas</span>
                                <strong id="stat-games-played">0</strong>
                            </div>
                            <div class="stat-item">
                                <span>Victorias</span>
                                <strong id="stat-games-won">0</strong>
                            </div>
                            <div class="stat-item">
                                <span>% de Victorias</span>
                                <strong id="stat-win-rate">0%</strong>
                            </div>
                            <div class="stat-item">
                                <span>Racha Actual</span>
                                <strong id="stat-win-streak">0</strong>
                            </div>
                            <div class="stat-item">
                                <span>Habilidades Usadas</span>
                                <strong id="stat-abilities-used">0</strong>
                            </div>
                            <div class="stat-item">
                                <span>Salas Creadas</span>
                                <strong id="stat-rooms-created">0</strong>
                            </div>
                        </div>
                    </div>
                    </div>

                <div class="lobby-column" id="actions-column">
                    <div class="card">
                        <h3>ğŸ†• Crear Sala Nueva</h3>
                        <div class="form-group">
                            <button id="btn-crear-sala" class="btn-primary" disabled>Crear Sala</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>ğŸšª Unirse a Sala</h3>
                        <div class="form-group">
                            <input type="text" id="codigo-sala" placeholder="CÃ³digo de sala" maxlength="8">
                            <button id="btn-unirse-sala" class="btn-primary" disabled>Unirse</button>
                        </div>
                    </div>
                </div>

                <div class="lobby-column" id="info-column">
                    <div class="info-section">
                        <div class="info-tabs">
                            <button id="btn-abrir-reglas" class="info-tab-button">ğŸ“– CÃ³mo Jugar</button>
                            <button id="tab-ranking" class="info-tab-button">Top 5</button>
                        </div>
                        
                        <div id="rules-content" class="info-content active">
                            <h3>ğŸ“‹ CÃ³mo Jugar - VoltRace</h3>
                            <ul>
                                <li><strong>Objetivo:</strong> SÃ© el primer jugador en llegar a la casilla 75 o el Ãºltimo en pie con energÃ­a.</li>
                                <li><strong>Jugadores:</strong> 2 a 4 personas por partida.</li>
                                <li><strong>EnergÃ­a:</strong> Empiezas con 600 puntos. Si llegas a 0, Â¡quedÃ¡s eliminado! Recoge packs ğŸ”‹ para ganar o perder energÃ­a.</li>
                                <li><strong>Tablero:</strong> Avanza segÃºn el dado ğŸ². Â¡Cuidado con las casillas especiales (Trampas ğŸ’€, Tesoros ğŸ’°, Portales ğŸŒ€)!</li>
                                <li><strong>Colisiones:</strong> Si caes en la misma casilla que otro jugador, Â¡ambos pierden energÃ­a! ğŸ’¥</li>
                                <li><strong>Habilidades:</strong> Cada jugador recibe 4 habilidades Ãºnicas al inicio. Ãšsalas estratÃ©gicamente, Â¡tienen un cooldown antes de poder volver a usarlas! â±ï¸</li>
                                <li><strong>Puntos de Mejora (PM):</strong> Gana Puntos de Mejora (PM) âœ¨ durante la partida al recoger energÃ­a o usar habilidades.</li>
                                <li><strong>Perks:</strong> Â¡Usa tus PM al inicio de tu turno para comprar Perks! Son ventajas pasivas que duran toda la partida. â­</li>
                                <li><strong>Ganador:</strong> Al llegar a la meta, el jugador vivo con mÃ¡s EnergÃ­a al final de la partida gana!. ğŸ†</li>
                            </ul>
                        </div>
                        <div id="ranking-content" class="info-content">
                            <h3>ğŸ† Top 5 Jugadores</h3>
                            <div id="top-players" class="top-players">
                                <div class="loading-rankings">Cargando rankings...</div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            </div>

        <div id="waiting-screen" class="screen">
            <div class="header">
                <h2>ğŸšª Sala: <span id="codigo-sala-actual"></span></h2>
                <button id="btn-copiar-codigo" class="btn-secondary">ğŸ“‹ Copiar CÃ³digo</button>
                <button id="btn-social-waiting" class="btn-secondary" title="Amigos y Chat">ğŸ‘¥ Social</button>
            </div>
            <div class="waiting-content">
                <div class="jugadores-lista">
                    <h3>ğŸ‘¥ Jugadores (<span id="contador-jugadores">0</span>/4)</h3>
                    <ul id="lista-jugadores"></ul>
                </div>
                <div class="chat-waiting">
                    <h3>ğŸ’¬ Chat de Sala</h3>
                    <div id="chat-mensajes" class="chat-mensajes"></div>
                    <div class="chat-input">
                        <input type="text" id="mensaje-input" placeholder="Escribe un mensaje...">
                        <button id="btn-enviar-mensaje">Enviar</button>
                    </div>
                </div>
                <div class="controles-sala">
                    <button id="btn-iniciar-juego" class="btn-success" disabled>ğŸ® Iniciar Juego</button>
                    <button id="btn-salir-sala" class="btn-danger">ğŸšª Salir de la Sala</button>
                </div>
                <div class="eventos-sala">
                    <h4>ğŸ“ Eventos</h4>
                    <ul id="log-eventos"></ul>
                </div>
            </div>
        </div>

        <div id="game-screen" class="screen">
            <div class="game-header">
                <div id="global-event-banner">
                    ğŸŒ Â¡EVENTO GLOBAL!
                </div>
                <div class="game-info">
                    <h2>ğŸ² VoltRace</h2>
                    <div class="game-stats">
                        <span>Ronda: <span id="ronda-actual">1</span></span>
                        <span>Turno: <span id="turno-jugador">-</span></span>
                    </div>
                    <div class="game-controls-global">
                        <button id="btn-toggle-animations-game" class="btn-secondary" title="Activar/Desactivar animaciones">ğŸ¬</button>
                        <div class="volume-control">
                            <span id="volume-icon-game" class="btn-secondary" title="Silenciar">ğŸ”Š</span>
                            <input type="range" id="volume-slider-game" min="0" max="1" step="0.01" value="0.5">
                        </div>
                    </div>
                </div>
            </div>
            <div class="game-content">
                <div class="panel-jugadores">
                    <h3>ğŸ‘¥ Jugadores</h3>
                    <div id="jugadores-estado"></div>
                </div>
                <div class="tablero-container">
                    <div id="tablero" class="tablero"></div>
                    <div class="controles-turno">
                        <button id="btn-mostrar-habilidades" class="btn-secondary">âš¡ Habilidades</button>
                        <button id="btn-lanzar-dado" class="btn-primary" disabled>ğŸ² Lanzar Dado</button>
                        <div id="resultado-dado" class="resultado-dado"></div>
                    </div>
                    <div id="guia-partida-drawer" class="guia-drawer">
                        <button id="guia-partida-toggle" class="guia-toggle-btn">
                            ğŸ“– GuÃ­a RÃ¡pida de SÃ­mbolos (Click para expandir)
                        </button>
                        <ul id="guia-partida-contenido" class="guia-contenido">
                            <li><strong>SÃ­mbolos de Casilla:</strong></li>
                            <li><strong>ğŸ’° Tesoro Menor:</strong> Ganas 70 de EnergÃ­a.</li>
                            <li><strong>ğŸ¤‘ Tesoro Mayor:</strong> Ganas 120 de EnergÃ­a.</li>
                            <li><strong>âŒ Trampa:</strong> Pierdes 60 de EnergÃ­a.</li>
                            <li><strong>â˜ ï¸ Trampa Peligrosa:</strong> Pierdes 80 de EnergÃ­a.</li>
                            <li><strong>ğŸŒ€ Portal MÃ¡gico:</strong> Te envÃ­a 3-5 casillas adelante.</li>
                            <li><strong>ğŸ’  Portal Avanzado:</strong> Te envÃ­a 4-6 casillas adelante.</li>
                            <li><strong>âœ¨ Multiplicador:</strong> Duplica la energÃ­a de tu prÃ³ximo pack/tesoro.</li>
                            <li><strong>ğŸ”„ Intercambio:</strong> Intercambias posiciÃ³n con un oponente al azar.</li>
                            <li><strong>ğŸ’¸ Peaje Costoso:</strong> Pierdes 75 de EnergÃ­a y 3 PM.</li>
                            <li><strong>âš¡ Turbo:</strong> Duplica tu siguiente tirada de dado.</li>
                            <li><strong>ğŸ§› Vampiro:</strong> Pierdes un 10% de tu energÃ­a actual.</li>
                            <li><strong>â†©ï¸ Rebote:</strong> Retrocedes 5-10 casillas.</li>
                            <li><strong>âš« Agujero Negro:</strong> Retrocedes 20 casillas.</li>
                            <li><strong>â­ Pozo de PM:</strong> Ganas 3 Puntos de Mejora (PM).</li>
                            <li><strong>ğŸ§² ImÃ¡n:</strong> Atraes a los demÃ¡s jugadores 2 casillas hacia ti.</li>
                            <li><strong>âš™ï¸ ChatarrerÃ­a:</strong> Intercambias 50 de EnergÃ­a por 3 PM.</li>
                            <li><br></li>
                            <li><strong>Iconos de Efectos (Jugador):</strong></li>
                            <li><strong>â¸ï¸ Pausa:</strong> PerderÃ¡s tu prÃ³ximo turno.</li>
                            <li><strong>ğŸ›¡ï¸ Escudo:</strong> Inmune a daÃ±o y habilidades negativas.</li>
                            <li><strong>âš¡ Turbo:</strong> Tu prÃ³xima tirada de dado se duplicarÃ¡.</li>
                            <li><strong>âœ¨ Multiplicador:</strong> Tu prÃ³ximo pack/tesoro se duplicarÃ¡.</li>
                            <li><strong>ğŸ‘» Invisible:</strong> No puedes ser objetivo de habilidades.</li>
                            <li><strong>ğŸ”® Barrera:</strong> Refleja la prÃ³xima habilidad negativa.</li>
                            <li><strong>ğŸ”„ Doble Dado:</strong> LanzarÃ¡s dos dados en tu prÃ³ximo turno.</li>
                            <li><strong>ğŸš« Bloqueo:</strong> No puedes ganar energÃ­a de packs/tesoros.</li>
                            <li><strong>ğŸ’¨ Fase:</strong> Ignoras casillas negativas y colisiones.</li>
                            <li><strong>ğŸ² Sobrecarga:</strong> Efecto aleatorio de energÃ­a en tu prÃ³ximo turno.</li>
                            <li><strong>ğŸ©¸ Fuga de EnergÃ­a:</strong> Pierdes energÃ­a al inicio de tu turno.</li>
                        </ul>
                    </div>
                </div> 
                <div class="panel-eventos">
                    <div class="eventos-juego">
                        <h4>ğŸ“‹ Eventos del Juego</h4>
                        <div id="eventos-lista" class="eventos-scroll"></div>
                    </div>
                    <div class="chat-juego">
                        <h4>ğŸ’¬ Chat</h4>
                        <div id="chat-juego-mensajes" class="chat-mensajes"></div>
                        <div class="chat-input">
                            <input type="text" id="mensaje-juego-input" placeholder="Mensaje...">
                            <button id="btn-enviar-mensaje-juego">ğŸ“¤</button>
                        </div>
                    </div>
                </div> 
            </div> 
        </div>

        <div id="modal-habilidades" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>âš¡ Tus Habilidades</h3>
                    <button id="btn-cerrar-habilidades" class="btn-close">Ã—</button>
                </div>
                <div id="habilidades-lista" class="habilidades-container"></div>
            </div>
        </div>
        <div id="modal-perks" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>â­ Compra de Perks</h3>
                    <button id="btn-cerrar-perks" class="btn-close">Ã—</button>
                </div>
                <div class="perks-info">
                    <span>Puntos de Mejora (PM): <strong id="pm-actual">0</strong></span>
                    <span>Perks Activos: <span id="perks-activos-list">-</span></span>
                </div>
                <h4>Selecciona un Pack:</h4>
                <div class="perk-packs">
                    <button id="btn-pack-basico" class="pack-button" data-pack-type="basico" data-cost="4">
                        <h4>Pack BÃ¡sico</h4>
                        <small>Coste: 4 PM</small>
                        <small>(Ofrece 2 BÃ¡sicos)</small>
                    </button>
                    <button id="btn-pack-intermedio" class="pack-button" data-pack-type="intermedio" data-cost="8">
                        <h4>Pack Intermedio</h4>
                        <small>Coste: 8 PM</small>
                        <small>(Ofrece 2 Medios, 1 BÃ¡sico)</small>
                    </button>
                    <button id="btn-pack-avanzado" class="pack-button" data-pack-type="avanzado" data-cost="12">
                        <h4>Pack Avanzado</h4>
                        <small>Coste: 12 PM</small>
                        <small>(Ofrece 1 Alto, 2 Medios)</small>
                    </button>
                </div>
                <div id="perk-offer-container">
                </div>
            </div>
        </div>
        <div id="modal-final" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>ğŸ† Â¡Juego Terminado!</h3>
                </div>
                <div id="resultados-finales" class="resultados-container"></div>
                <div class="modal-footer">
                    <button id="btn-nueva-partida" class="btn-primary">ğŸ® Nueva Partida</button>
                    <button id="btn-volver-lobby" class="btn-secondary">ğŸ  Volver al Lobby</button>
                </div>
            </div>
        </div>
        <div id="modal-private-chat" class="modal">
            <div class="modal-content">
                <div class="social-header">
                    <h3>ğŸ’¬ Chat con <span id="chat-with-username"></span></h3>
                    <button id="btn-cerrar-private-chat" class="btn-close">Ã—</button>
                </div>
                <div id="private-chat-messages"></div>
                <div id="private-chat-input-group" class="chat-input">
                    <input type="text" id="private-chat-input" placeholder="Escribe un mensaje...">
                    <button id="private-chat-send" class="btn-primary">Enviar</button>
                </div>
            </div>
        </div>
        <div id="modal-social" class="modal">
            <div class="modal-content">
                <div class="social-header">
                    <h3>ğŸ‘¥ Social</h3>
                    <button id="btn-cerrar-social" class="btn-close">Ã—</button>
                </div>
                <div class="social-tabs">
                    <button id="social-tab-friends" class="social-tab-button active">Amigos</button>
                    <button id="social-tab-requests" class="social-tab-button">Solicitudes</button>
                    <button id="social-tab-search" class="social-tab-button">Buscar</button>
                </div>
                <div id="social-content-friends" class="social-content active">
                    <div id="social-friends-list">Cargando amigos...</div>
                </div>
                <div id="social-content-requests" class="social-content">
                    <div id="social-requests-list">Cargando solicitudes...</div>
                </div>
                <div id="social-content-search" class="social-content">
                    <div class="social-search-bar">
                        <input type="text" id="social-search-input" placeholder="Buscar usuario...">
                        <button id="social-search-button" class="btn-primary">Buscar</button>
                    </div>
                    <div id="social-search-results"></div>
                </div>
            </div>
        </div>
        <div id="modal-achievements" class="modal">
            <div class="modal-content" style="max-height: 80vh; overflow-y: auto;">
                <div class="modal-header">
                    <h3>ğŸ† Mis Logros</h3>
                    <button id="btn-cerrar-achievements" class="btn-close">Ã—</button>
                </div>
                <div id="achievements-summary" style="text-align: center; margin-bottom: 15px; color: var(--muted);">
                    Cargando progreso...
                </div>
                <div id="achievements-list" style="display: flex; flex-direction: column; gap: 10px;">
                </div>
            </div>
        </div>
        <div id="modal-arsenal" class="modal">
            <div class="modal-content" style="max-height: 80vh; overflow-y: auto;">
                <div class="modal-header">
                    <h3>ğŸ›¡ï¸ MaestrÃ­a de Kits (Arsenal)</h3>
                    <button id="btn-cerrar-arsenal" class="btn-close">Ã—</button>
                </div>
                <div id="arsenal-content">
                    <div id="arsenal-lock-message" style="display:none; text-align: center; color: var(--muted); padding: 20px;">
                        <span style="font-size: 2em;">ğŸ”’</span>
                        <p>El sistema de MaestrÃ­a de Kit se desbloquea al **Nivel de Cuenta 5**.</p>
                        <p>Â¡Sigue jugando para desbloquearlo!</p>
                    </div>
                    <div id="arsenal-kit-list">
                        </div>
                </div>
            </div>
        </div>
        <div id="modal-glossary" class="modal">
            <div class="modal-content" style="max-height: 80vh; overflow-y: auto;">
                <div class="modal-header">
                    <h3>ğŸ“š Glosario</h3>
                    <button id="btn-cerrar-glossary" class="btn-close">Ã—</button>
                </div>
                <div id="glossary-content-inner">
                    <div class="glossary-section">
                        <h3>âš¡ Habilidades</h3>
                        <div id="glossary-abilities-list" class="glossary-list">
                            <p>Cargando habilidades...</p>
                        </div>
                    </div>
                    <div class="glossary-section">
                        <h3>â­ Perks</h3>
                        <div id="glossary-perks-list" class="glossary-list">
                            <p>Cargando perks...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="modal-kits" class="modal" style="display:none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>ğŸ› ï¸ Elegir Kit</h3>
                    <span class="btn-close" id="close-modal-kits">&times;</span>
                </div>
                <p>Esta serÃ¡ tu configuraciÃ³n de habilidades al entrar en una partida. Tu elecciÃ³n se guardarÃ¡.</p>
                <div id="contenedor-kits">
                    <div class="kit-card" data-kit="tactico">
                        <h3>TÃ¡ctico</h3>
                        <p>Control y precisiÃ³n. DÃ©bil contra daÃ±o directo, pero excelente para controlar oponentes.</p>
                        <ul>
                            <li>Sabotaje</li>
                            <li>Barrera</li>
                            <li>Rebote Controlado</li>
                            <li>Dado Perfecto</li>
                        </ul>
                    </div>
                    <div class="kit-card" data-kit="ingeniero">
                        <h3>Ingeniero</h3>
                        <p>Zona y velocidad. RÃ¡pido para escapar y poner trampas.</p>
                        <ul>
                            <li>Bomba EnergÃ©tica</li>
                            <li>Invisibilidad</li>
                            <li>Cohete</li>
                            <li>Mina de EnergÃ­a</li>
                        </ul>
                    </div>
                    <div class="kit-card" data-kit="espectro">
                        <h3>Espectro</h3>
                        <p>Caos y evasiÃ³n. Ignora las reglas del tablero y altera posiciones.</p>
                        <ul>
                            <li>Fuga de EnergÃ­a</li>
                            <li>Transferencia de Fase</li>
                            <li>Intercambio Forzado</li>
                            <li>Caos</li>
                        </ul>
                    </div>
                    <div class="kit-card" data-kit="guardian">
                        <h3>GuardiÃ¡n</h3>
                        <p>Anti-habilidades. DifÃ­cil de matar y castiga a quienes dependen de la energÃ­a.</p>
                        <ul>
                            <li>Tsunami</li>
                            <li>Escudo Total</li>
                            <li>Retroceso</li>
                            <li>Bloqueo EnergÃ©tico</li>
                        </ul>
                    </div>
                    <div class="kit-card" data-kit="estratega">
                        <h3>El Estratega</h3>
                        <p>Alto riesgo, alta recompensa. Sin escape, pero gran control y tempo.</p>
                        <ul>
                            <li>Robo</li>
                            <li>CuraciÃ³n</li>
                            <li>Doble Turno</li>
                            <li>Sobrecarga Inestable</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="modal-avatar" class="modal" style="display:none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Elige tu Avatar</h3>
                    <span class="btn-close" id="btn-cerrar-avatar">&times;</span>
                </div>
                <p>Haz clic en un emoji para seleccionarlo como tu avatar y ficha de juego.</p>
                <div id="avatar-selection-grid">
                    <button class="avatar-btn" data-emoji="ğŸ¦„">ğŸ¦„</button>
                    <button class="avatar-btn" data-emoji="ğŸ²">ğŸ²</button>
                    <button class="avatar-btn" data-emoji="ğŸ¦–">ğŸ¦–</button>
                    <button class="avatar-btn" data-emoji="ğŸ™">ğŸ™</button>
                    <button class="avatar-btn" data-emoji="ğŸ¦Š">ğŸ¦Š</button>
                    <button class="avatar-btn" data-emoji="ğŸ¼">ğŸ¼</button>
                    <button class="avatar-btn" data-emoji="ğŸ¦">ğŸ¦</button>
                    <button class="avatar-btn" data-emoji="ğŸ¸">ğŸ¸</button>
                    <button class="avatar-btn" data-emoji="ğŸ¤–">ğŸ¤–</button>
                    <button class="avatar-btn" data-emoji="ğŸ‘½">ğŸ‘½</button>
                    <button class="avatar-btn" data-emoji="ğŸ‘»">ğŸ‘»</button>
                    <button class="avatar-btn" data-emoji="ğŸ¤ ">ğŸ¤ </button>
                    <button class="avatar-btn" data-emoji="ğŸ§™">ğŸ§™</button>
                    <button class="avatar-btn" data-emoji="ğŸ§›">ğŸ§›</button>
                    <button class="avatar-btn" data-emoji="ğŸ§Ÿ">ğŸ§Ÿ</button>
                    <button class="avatar-btn" data-emoji="âš¡">âš¡</button>
                    <button class="avatar-btn" data-emoji="ğŸš€">ğŸš€</button>
                    <button class="avatar-btn" data-emoji="ğŸ¯">ğŸ¯</button>
                    <button class="avatar-btn" data-emoji="ğŸ’¥">ğŸ’¥</button>
                    <button class="avatar-btn" data-emoji="â˜„ï¸">â˜„ï¸</button>
                    <button class="avatar-btn" data-emoji="â˜¢ï¸">â˜¢ï¸</button>
                    <button class="avatar-btn" data-emoji="ğŸ’">ğŸ’</button>
                    <button class="avatar-btn" data-emoji="ğŸ‘‘">ğŸ‘‘</button>
                    <button class="avatar-btn" data-emoji="ğŸ€">ğŸ€</button>
                    <button class="avatar-btn" data-emoji="ğŸ„">ğŸ„</button>
                    <button class="avatar-btn" data-emoji="ğŸª">ğŸª</button>
                    <button class="avatar-btn" data-emoji="ğŸ”¥">ğŸ”¥</button>
                    <button class="avatar-btn" data-emoji="ğŸ’€">ğŸ’€</button>
                    <button class="avatar-btn" data-emoji="ğŸ‘¤">ğŸ‘¤</button>
                </div>
            </div>
        </div>

        <div id="notificaciones" class="notificaciones-container"></div>

        <div id="loading" class="loading-overlay">
            <div class="loading-spinner">ğŸ²</div>
            <p>Conectando...</p>
        </div>
    </div> 
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>

    <script src="{{ url_for('static', filename='js/main.js') }}" type="module"></script>
    </body>
</html>